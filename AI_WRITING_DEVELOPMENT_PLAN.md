# AI 智能写作助手开发计划

## 📋 开发流程说明

本计划按照功能模块逐步开发，**每个功能完成后必须进行验证，验证通过后才能继续下一个功能**。

---

## 🎯 Phase 1: 后端 API 开发

### ✅ 任务 1: 后端基础架构

**任务内容**：
- 创建 `ai-writing.controller.ts` 控制器
- 创建相关 DTO 类型定义
- 在 `ai.module.ts` 中注册控制器

**验证标准**：
- [ ] 控制器文件创建成功
- [ ] 模块注册成功，服务可正常启动
- [ ] Swagger 文档中可以看到新的 API 端点（即使未实现）

**验证命令**：
```bash
# 启动服务，检查是否有错误
cd easy-blog-service
pnpm run start:dev

# 访问 Swagger 文档
# http://localhost:8000/blog-service/docs
# 检查是否有 ai-writing 标签和端点
```

---

### ✅ 任务 2: 生成标题接口

**任务内容**：
- 实现 `POST /ai/writing/generate-title` 接口
- 支持 `content` 和可选的 `style` 参数
- 调用 `aiService.generateTitle()` 方法

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 传入内容后能返回标题
- [ ] 支持不同风格参数（concise/attractive/technical/seo）
- [ ] 错误处理正常（空内容、API 错误等）

**验证步骤**：
```bash
# 使用 curl 测试
curl -X POST http://localhost:8000/blog-service/ai/writing/generate-title \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "content": "这是一篇关于NestJS框架的技术文章，介绍了其特点、优势和使用场景"
  }'

# 或使用 Swagger UI 测试
# 1. 访问 http://localhost:8000/blog-service/docs
# 2. 找到 ai-writing / generate-title 端点
# 3. 点击 Try it out
# 4. 输入测试数据并执行
# 5. 检查返回结果
```

**预期结果**：
```json
{
  "content": "NestJS框架：现代化Node.js应用开发指南"
}
```

---

### ✅ 任务 3: 生成摘要接口

**任务内容**：
- 实现 `POST /ai/writing/generate-summary` 接口
- 支持 `content` 和可选的 `maxLength` 参数
- 调用 `aiService.generateSummary()` 方法

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 能根据文章内容生成摘要
- [ ] 支持指定最大长度限制
- [ ] 超长文章自动使用 qwen-long 模型

**验证步骤**：
```bash
# 测试摘要生成
curl -X POST http://localhost:8000/blog-service/ai/writing/generate-summary \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "content": "这是一篇很长的文章内容...",
    "maxLength": 200
  }'
```

**预期结果**：
```json
{
  "content": "本文介绍了NestJS框架的核心特性..."
}
```

---

### ✅ 任务 4: 生成内容接口

**任务内容**：
- 实现 `POST /ai/writing/generate-content` 接口
- 支持 `prompt`、可选的 `context` 和 `model` 参数
- 调用 `aiService.generateContent()` 方法

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 根据提示词生成内容
- [ ] 支持上下文信息
- [ ] 支持指定模型

**验证步骤**：
```bash
# 测试内容生成
curl -X POST http://localhost:8000/blog-service/ai/writing/generate-content \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "prompt": "写一篇关于TypeScript的技术文章",
    "context": "目标读者是中级开发者"
  }'
```

---

### ✅ 任务 5: 优化内容接口

**任务内容**：
- 实现 `POST /ai/writing/optimize` 接口
- 支持 `content`、可选的 `instruction` 和 `model` 参数
- 调用 `aiService.optimizeContent()` 方法

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 能优化文章内容
- [ ] 支持自定义优化指令
- [ ] 优化结果质量良好

**验证步骤**：
```bash
# 测试内容优化
curl -X POST http://localhost:8000/blog-service/ai/writing/optimize \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "content": "这是一段需要优化的文本...",
    "instruction": "使语言更专业"
  }'
```

---

### ✅ 任务 6: 续写接口

**任务内容**：
- 实现 `POST /ai/writing/continue` 接口
- 支持 `content` 和可选的 `position` 参数
- 基于当前内容智能续写

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 能基于现有内容续写
- [ ] 续写内容风格一致
- [ ] 支持指定续写位置

**验证步骤**：
```bash
# 测试续写功能
curl -X POST http://localhost:8000/blog-service/ai/writing/continue \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "content": "NestJS是一个强大的Node.js框架..."
  }'
```

---

### ✅ 任务 7: 文章分析接口

**任务内容**：
- 实现 `POST /ai/writing/analyze` 接口
- 支持 `content` 和可选的 `title` 参数
- 返回文章质量分析和建议

**验证标准**：
- [ ] 接口可以正常调用
- [ ] 能分析文章质量
- [ ] 返回结构化的分析结果
- [ ] 包含改进建议

**验证步骤**：
```bash
# 测试文章分析
curl -X POST http://localhost:8000/blog-service/ai/writing/analyze \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "content": "文章完整内容...",
    "title": "文章标题"
  }'
```

---

### ✅ 任务 8: 后端 API 完整验证

**任务内容**：
- 使用 Swagger 或 Postman 测试所有接口
- 验证错误处理
- 验证权限控制（JWT认证）

**验证标准**：
- [ ] 所有接口都能正常调用
- [ ] 错误情况处理正确
- [ ] 未授权访问被正确拦截
- [ ] 响应格式统一

**验证清单**：
- [ ] generate-title - 正常/错误/空内容
- [ ] generate-summary - 正常/超长内容/指定长度
- [ ] generate-content - 正常/带上下文/指定模型
- [ ] optimize - 正常/自定义指令
- [ ] continue - 正常/不同位置
- [ ] analyze - 正常/带标题/不带标题

---

## 🎨 Phase 2: 前端基础开发

### ✅ 任务 9: 前端 API 客户端

**任务内容**：
- 创建 `api/ai-writing/index.ts` 文件
- 封装所有 AI 写作接口调用
- 使用统一的请求客户端

**验证标准**：
- [ ] API 文件创建成功
- [ ] 所有接口方法已定义
- [ ] TypeScript 类型定义完整
- [ ] 可以正常导入使用

**验证步骤**：
```typescript
// 在浏览器控制台或组件中测试
import aiWritingApi from '@/api/ai-writing';

// 检查方法是否存在
console.log(aiWritingApi.generateTitle);
console.log(aiWritingApi.generateSummary);
// ... 其他方法
```

---

### ✅ 任务 10: AI 工具栏组件

**任务内容**：
- 创建 `AIEditorToolbar.tsx` 组件
- 包含 AI写作/优化/续写 按钮
- 实现基础交互逻辑

**验证标准**：
- [ ] 组件可以正常渲染
- [ ] 按钮正常显示
- [ ] 点击按钮有响应（可以显示 loading）
- [ ] 选中文本时优化按钮可用

**验证步骤**：
1. 在 PostEditor 中临时引入组件
2. 检查按钮是否显示
3. 点击按钮检查控制台是否有日志
4. 选中编辑器中的文本，检查优化按钮状态

---

### ✅ 任务 11: AI 写作面板组件

**任务内容**：
- 创建 `AIWritingPanel.tsx` 组件
- 实现提示词输入、生成、插入功能
- 添加加载状态和错误处理

**验证标准**：
- [ ] 面板可以正常打开/关闭
- [ ] 输入框正常工作
- [ ] 点击生成按钮有响应
- [ ] 加载状态正常显示
- [ ] 生成的内容可以插入

**验证步骤**：
1. 在组件中临时添加测试按钮打开面板
2. 输入提示词并点击生成
3. 检查是否显示加载状态
4. 检查生成的内容是否正确显示
5. 点击插入按钮，检查内容是否插入到编辑器

---

## 🔗 Phase 3: 前端功能集成

### ✅ 任务 12: 标题生成功能

**任务内容**：
- 在 PostForm 标题输入框旁添加 AI 生成按钮
- 实现标题生成功能
- 添加加载状态和错误提示

**验证标准**：
- [ ] 按钮正常显示
- [ ] 点击按钮可以生成标题
- [ ] 生成的标题自动填入输入框
- [ ] 错误情况有友好提示
- [ ] 加载状态正常显示

**验证步骤**：
1. 进入文章创建页面
2. 输入一些内容或摘要
3. 点击标题旁的 AI 生成按钮
4. 检查是否显示加载状态
5. 检查生成的标题是否正确填入
6. 测试错误情况（无内容时点击）

---

### ✅ 任务 13: 摘要生成功能

**任务内容**：
- 在 PostForm 摘要输入框旁添加 AI 生成按钮
- 实现摘要生成功能
- 支持指定长度

**验证标准**：
- [ ] 按钮正常显示
- [ ] 点击按钮可以生成摘要
- [ ] 生成的摘要自动填入输入框
- [ ] 支持重新生成

**验证步骤**：
1. 进入文章创建页面
2. 输入文章内容
3. 点击摘要旁的 AI 生成按钮
4. 检查生成的摘要是否正确
5. 测试重新生成功能

---

### ✅ 任务 14: 集成 AI 工具栏

**任务内容**：
- 将 AIEditorToolbar 集成到 PostEditor 工具栏
- 确保按钮正常显示和交互
- 处理编辑器状态

**验证标准**：
- [ ] 工具栏正常显示在编辑器中
- [ ] 按钮样式与原有工具栏一致
- [ ] 点击按钮功能正常
- [ ] 编辑器状态正确传递

**验证步骤**：
1. 进入文章编辑页面
2. 检查编辑器工具栏是否包含 AI 按钮
3. 测试每个按钮的功能
4. 检查编辑器内容是否正确更新

---

### ✅ 任务 15: 内容优化功能

**任务内容**：
- 实现选中文本优化功能
- 显示优化结果对比
- 支持应用/拒绝优化

**验证标准**：
- [ ] 选中文本后优化按钮可用
- [ ] 点击优化后显示结果
- [ ] 可以预览优化后的内容
- [ ] 支持应用或拒绝优化
- [ ] 优化后的内容正确插入

**验证步骤**：
1. 在编辑器中输入一些文本
2. 选中一段文本
3. 点击优化按钮
4. 检查是否显示优化结果
5. 测试应用和拒绝功能

---

### ✅ 任务 16: 续写功能

**任务内容**：
- 实现续写功能
- 在编辑器末尾插入续写内容
- 添加加载状态

**验证标准**：
- [ ] 续写按钮正常显示
- [ ] 点击续写后能生成内容
- [ ] 生成的内容插入到编辑器末尾
- [ ] 续写内容风格一致

**验证步骤**：
1. 在编辑器中输入一些内容
2. 点击续写按钮
3. 检查是否显示加载状态
4. 检查续写内容是否正确插入
5. 检查续写内容是否与原文风格一致

---

## ✅ Phase 4: 功能验证

### ✅ 任务 17: 前端基础功能验证

**验证清单**：
- [ ] 标题生成功能完整可用
- [ ] 摘要生成功能完整可用
- [ ] 内容生成功能完整可用
- [ ] UI 交互流畅
- [ ] 错误提示友好

**验证步骤**：
1. 创建一篇新文章
2. 测试标题生成
3. 测试摘要生成
4. 测试内容生成
5. 检查所有交互是否流畅

---

### ✅ 任务 18: 前端高级功能验证

**验证清单**：
- [ ] 内容优化功能完整可用
- [ ] 续写功能完整可用
- [ ] 所有功能错误处理正常
- [ ] 加载状态正常显示

**验证步骤**：
1. 测试内容优化功能
2. 测试续写功能
3. 测试各种错误情况
4. 检查加载状态

---

## 🚀 Phase 5: 优化与完善

### ✅ 任务 19: 错误处理完善

**任务内容**：
- 完善网络错误处理
- 完善 API 错误处理
- 添加超时处理
- 添加重试机制

**验证标准**：
- [ ] 网络错误有友好提示
- [ ] API 错误信息清晰
- [ ] 超时情况有处理
- [ ] 支持手动重试

---

### ✅ 任务 20: 加载状态优化

**任务内容**：
- 所有 AI 操作添加加载动画
- 添加进度提示
- 支持取消操作

**验证标准**：
- [ ] 所有操作都有加载状态
- [ ] 长时间操作显示进度
- [ ] 可以取消正在进行的操作

---

### ✅ 任务 21: 性能优化

**任务内容**：
- 添加防抖处理
- 实现请求缓存
- 优化响应时间

**验证标准**：
- [ ] 频繁操作不会重复请求
- [ ] 相同内容使用缓存
- [ ] 响应时间在可接受范围内

---

### ✅ 任务 22: 用户体验优化

**任务内容**：
- 优化 UI 布局
- 改进交互流程
- 添加操作提示

**验证标准**：
- [ ] UI 布局美观
- [ ] 交互流程顺畅
- [ ] 操作提示清晰

---

### ✅ 任务 23: 最终完整验证

**验证清单**：
- [ ] 所有功能完整可用
- [ ] 错误处理完善
- [ ] 性能表现良好
- [ ] 用户体验流畅
- [ ] 代码质量良好

**端到端测试场景**：
1. **场景1：创建新文章并使用AI辅助**
   - 创建新文章
   - 使用AI生成标题
   - 使用AI生成摘要
   - 使用AI生成内容
   - 使用AI优化内容
   - 保存文章

2. **场景2：编辑现有文章并使用AI优化**
   - 打开现有文章
   - 选中文本并优化
   - 使用续写功能
   - 保存文章

3. **场景3：错误处理测试**
   - 网络断开情况
   - API 错误情况
   - 超时情况
   - 空内容情况

---

## 📝 开发注意事项

1. **每完成一个任务，必须验证通过后才能继续下一个**
2. **遇到问题及时记录和解决**
3. **保持代码质量，遵循项目规范**
4. **及时提交代码，写好提交信息**

---

## 🎯 完成标准

所有任务完成后，应该达到：
- ✅ 所有后端 API 功能完整可用
- ✅ 所有前端功能完整可用
- ✅ 错误处理完善
- ✅ 用户体验良好
- ✅ 性能表现良好
- ✅ 代码质量良好

---

**文档版本**：v1.0  
**最后更新**：2025-11-17

